<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>neurocaps.analysis.CAP &mdash; neurocaps 0.9.8 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
      <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=2c5bc8c0" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=1a282f62"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="neurocaps.analysis.merge_dicts" href="neurocaps.analysis.merge_dicts.html" />
    <link rel="prev" title="neurocaps.extraction.TimeseriesExtractor" href="neurocaps.extraction.TimeseriesExtractor.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            neurocaps
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../api.html#module-neurocaps.extraction"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neurocaps.extraction</span></code> - Timeseries Extraction, Pickling, &amp; Visualization</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#module-neurocaps.analysis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neurocaps.analysis</span></code> - Co-Activation Patterns (CAPs) Analysis</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neurocaps.analysis</span></code>.CAP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#neurocaps.analysis.CAP"><code class="docutils literal notranslate"><span class="pre">CAP</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="neurocaps.analysis.merge_dicts.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neurocaps.analysis</span></code>.merge_dicts</a></li>
<li class="toctree-l3"><a class="reference internal" href="neurocaps.analysis.standardize.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neurocaps.analysis</span></code>.standardize</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">neurocaps</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api.html">API</a></li>
      <li class="breadcrumb-item active"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neurocaps.analysis</span></code>.CAP</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/generated/neurocaps.analysis.CAP.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="neurocaps-analysis-cap">
<h1><a class="reference internal" href="../api.html#module-neurocaps.analysis" title="neurocaps.analysis"><code class="xref py py-mod docutils literal notranslate"><span class="pre">neurocaps.analysis</span></code></a>.CAP<a class="headerlink" href="#neurocaps-analysis-cap" title="Link to this heading"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="neurocaps.analysis.CAP">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">neurocaps.analysis.</span></span><span class="sig-name descname"><span class="pre">CAP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">parcel_approach</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_selection_method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groups</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/neurocaps/analysis/cap.html#CAP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurocaps.analysis.CAP" title="Link to this definition"></a></dt>
<dd><p>Co-Activation Patterns (CAPs) Class</p>
<p>Initializes the CAPs (Co-activation Patterns) class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parcel_approach</strong> (<em>Dict</em><em>[</em><em>Dict</em><em>]</em>) – <p>The approach used to parcellate BOLD images. This should be a nested dictionary with the first key being the atlas name. The subkeys should include:</p>
<ul>
<li><p>”nodes”: A list of node names in the order of the label IDs in the parcellation.</p></li>
<li><p>”regions”: The regions or networks in the parcellation.</p></li>
<li><p>”maps”: Directory path to the location of the parcellation file.</p></li>
</ul>
<p>If the “Schaefer” or “AAL” option was used in the <cite>TimeSeriesExtractor</cite> class, you can initialize the <cite>TimeSeriesExtractor</cite> class with the <cite>parcel_approach</cite>
that was initially used, then set this parameter to <cite>TimeSeriesExtractor.parcel_approach</cite>. For this parameter, only “Schaefer”, “AAL”, and “Custom” are supported.</p>
</p></li>
<li><p><strong>n_clusters</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>default=5</em>) – The number of clusters to use. Can be a single integer or a list of integers.</p></li>
<li><p><strong>cluster_selection_method</strong> (<em>str</em><em>, </em><em>default=None</em>) – Method to find the optimal number of clusters. Options are “silhouette” or “elbow”.</p></li>
<li><p><strong>groups</strong> (<em>dict</em><em>, </em><em>default=None</em>) – A mapping of group names to subject IDs. Each group contains subject IDs for separate CAP analysis. If None, CAPs are not separated by group.</p></li>
</ul>
</dd>
</dl>
<section id="notes-for-parcel-approach">
<h2>Notes for <code class="docutils literal notranslate"><span class="pre">parcel_approach</span></code><a class="headerlink" href="#notes-for-parcel-approach" title="Link to this heading"></a></h2>
<p>If using a “Custom” parcellation approach, ensure each node in your dataset includes both left (lh) and right (rh) hemisphere versions. This function assumes that the background label is “zero”.
Do not add a background label in the “nodes” or “networks” key; the zero index should correspond to the first ID that is not zero.</p>
</section>
<section id="custom-key-structure">
<h2>Custom Key Structure:<a class="headerlink" href="#custom-key-structure" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>‘maps’: Directory path containing necessary parcellation files. Ensure files are in a supported format (e.g., .nii for NIfTI files). For plotting purposes, this key is not required.</p></li>
<li><dl class="simple">
<dt>‘nodes’: List of all node labels used in your study, arranged in the exact order they correspond to indices in your parcellation files.</dt><dd><p>Each label should match the parcellation index it represents. For example, if the parcellation label “1” corresponds to the left hemisphere
visual cortex area 1, then “LH_Vis1” should occupy the 0th index in this list. This ensures that data extraction and analysis accurately reflect the anatomical regions intended.
For timeseries extraction, this key is not required.</p>
</dd>
</dl>
</li>
<li><p>‘regions’: Dictionary defining major brain regions. Each region should list node indices under “lh” and “rh” to specify left and right hemisphere nodes.</p></li>
</ul>
<p class="rubric">Example</p>
<p>The provided example demonstrates setting up a custom parcellation containing nodes for the visual network (Vis) and hippocampus regions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parcel_approach</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;Custom&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;maps&quot;</span><span class="p">:</span> <span class="s2">&quot;/location/to/parcellation.nii.gz&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;LH_Vis1&quot;</span><span class="p">,</span> <span class="s2">&quot;LH_Vis2&quot;</span><span class="p">,</span> <span class="s2">&quot;LH_Hippocampus&quot;</span><span class="p">,</span> <span class="s2">&quot;RH_Vis1&quot;</span><span class="p">,</span> <span class="s2">&quot;RH_Vis2&quot;</span><span class="p">,</span> <span class="s2">&quot;RH_Hippocampus&quot;</span><span class="p">],</span>
                        <span class="s2">&quot;regions&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;Vis&quot;</span> <span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lh&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span>
                                            <span class="s2">&quot;rh&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]},</span>
                                    <span class="s2">&quot;Hippocampus&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;lh&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">2</span><span class="p">],</span>
                                                    <span class="s2">&quot;rh&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">]}}}}</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="neurocaps.analysis.CAP.get_caps">
<span class="sig-name descname"><span class="pre">get_caps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subject_timeseries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">array</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'k-means++'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'random'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'k-means++'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_init</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'auto'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iter</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.0001</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algorithm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'lloyd'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'elkan'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lloyd'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_figs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">standardize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_cores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/neurocaps/analysis/cap.html#CAP.get_caps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurocaps.analysis.CAP.get_caps" title="Link to this definition"></a></dt>
<dd><p>Generate CAPs</p>
<p>Concatenates the timeseries of each subject and performs k-means clustering on the concatenated data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subject_timeseries</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em><em>] or </em><em>str</em>) – Path of the pickle file containing the nested subject timeseries dictionary saved by the TimeSeriesExtractor class or
the nested subject timeseries dictionary produced by the TimeseriesExtractor class. The first level of the nested dictionary must consist of the subject ID as a string,
the second level must consist of the run numbers in the form of ‘run-#’ (where # is the corresponding number of the run), and the last level must consist of the timeseries
(as a numpy array) associated with that run.</p></li>
<li><p><strong>runs</strong> (<em>int</em><em> or </em><em>list</em><em>[</em><em>int</em><em>]</em><em>, </em><em>default=None</em>) – The run numbers to perform the CAPs analysis with. If None, all runs in the subject timeseries will be concatenated into a single dataframe and subjected to k-means clustering.</p></li>
<li><p><strong>random_state</strong> (<em>int</em><em>, </em><em>default=None</em>) – The random state to use for scikit’s KMeans function.</p></li>
<li><p><strong>init</strong> (<em>&quot;k-means++&quot;</em><em>, </em><em>&quot;random&quot;</em><em>, or </em><em>array</em><em>, </em><em>default=&quot;k-means++&quot;</em>) – Method for choosing initial cluster centroid. Refer to scikit’s KMeans documentation for more information.</p></li>
<li><p><strong>n_init</strong> (<em>&quot;auto&quot;</em><em> or </em><em>int</em><em>, </em><em>default=&quot;auto&quot;</em>) – Number of times KMeans is ran with different initial clusters. The model with lowest inertia from these runs will be selected.
Refer to scikit’s KMeans documentation for more information.</p></li>
<li><p><strong>max_iter</strong> (<em>int</em><em>, </em><em>default=300</em>) – Maximum number of iterations for a single run of KMeans.</p></li>
<li><p><strong>tol</strong> (<em>float</em><em>, </em><em>default=1e-4</em><em>,</em>) – Stopping criterion if the change in inertia is below this value, assuming <cite>max_iter</cite> has not been reached.</p></li>
<li><p><strong>algorithm</strong> (<em>&quot;lloyd</em><em> or </em><em>&quot;elkan&quot;</em><em>, </em><em>default=&quot;lloyd&quot;</em>) – The type of algorithm to use. Refer to scikit’s KMeans documentation for more information.</p></li>
<li><p><strong>show_figs</strong> (<em>bool</em><em>, </em><em>default=False</em>) – Display the plots of inertia scores for all groups if <cite>cluster_selection_method</cite> is set to “elbow”.</p></li>
<li><p><strong>output_dir</strong> (<em>str</em><em>, </em><em>default=None</em>) – Directory to save plot to if <cite>cluster_selection_method</cite> is set to “elbow”. The directory will be created if it does not exist.</p></li>
<li><p><strong>standardize</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to z-score the features of the concatenated timeseries data.</p></li>
<li><p><strong>epsilon</strong> (<em>int</em><em> or </em><em>float</em><em>, </em><em>default=0</em>) – A small number to add to the denominator when z-scoring for numerical stability.</p></li>
<li><p><strong>n_cores</strong> (<em>int</em><em>, </em><em>default=None</em>) – The number of CPU cores to use for multiprocessing, with joblib, to run multiple kmeans models if <cite>cluster_selection_method</cite> is not None.</p></li>
<li><p><strong>kwargs</strong> (<em>Dict</em>) – <p>Dictionary to adjust certain parameters related to <cite>cluster_selection_method</cite> when set to “elbow”. Additional parameters include:</p>
<blockquote>
<div><ul>
<li><p>”S”: Adjusts the sensitivity of finding the elbow. Larger values are more conservative and less sensitive to small fluctuations. This package uses KneeLocator from the kneed package to identify the elbow. Default is 1.</p></li>
<li><p>”dpi”: Adjusts the dpi of the elbow plot. Default is 300.</p></li>
<li><p>”figsize”: Adjusts the size of the elbow plots.</p></li>
</ul>
</div></blockquote>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>matplotlib.Figure</em> – An instance of a matplotlib figure.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neurocaps.analysis.CAP.calculate_metrics">
<span class="sig-name descname"><span class="pre">calculate_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">subject_timeseries</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">ndarray</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tr</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">continuous_runs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['temporal</span> <span class="pre">fraction',</span> <span class="pre">'persistence',</span> <span class="pre">'counts',</span> <span class="pre">'transition</span> <span class="pre">frequency']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/neurocaps/analysis/cap.html#CAP.calculate_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurocaps.analysis.CAP.calculate_metrics" title="Link to this definition"></a></dt>
<dd><p>Get CAPs metrics</p>
<p>Creates a single pandas DataFrame containing CAP metrics for all participants, as described in Liu et al., 2018 and Yang et al., 2021.
The metrics include:</p>
<ul class="simple">
<li><p>‘temporal fraction’: The proportion of total volumes spent in a single CAP over all volumes in a run.</p></li>
<li><p>‘persistence;: The average time spent in a single CAP before transitioning to another CAP (average consecutive/uninterrupted time).</p></li>
<li><p>‘counts’: The frequency of each CAP observed in a run.</p></li>
<li><p>‘transition frequency’: The number of switches between different CAPs across the entire run.</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>subject_timeseries</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em><em>] or </em><em>str</em>) – Path of the pickle file containing the nested subject timeseries dictionary saved by the TimeSeriesExtractor class or
the nested subject timeseries dictionary produced by the TimeseriesExtractor class. The first level of the nested dictionary must consist of the subject ID as a string,
the second level must consist of the run numbers in the form of ‘run-#’ (where # is the corresponding number of the run), and the last level must consist of the timeseries
(as a numpy array) associated with that run.</p></li>
<li><p><strong>tr</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – The repetition time (TR). If provided, persistence will be calculated as the average uninterrupted time spent in each CAP.
If not provided, persistence will be calculated as the average uninterrupted volumes (TRs) spent in each state.</p></li>
<li><p><strong>runs</strong> (<em>int</em><em> or </em><em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>default=None</em>) – The run numbers to calculate CAP metrics for. If None, CAP metrics will be calculated for each run.</p></li>
<li><p><strong>continuous_runs</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, all runs will be treated as a single, uninterrupted run.</p></li>
<li><p><strong>metrics</strong> (<em>str</em><em> or </em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default=</em><em>[</em><em>&quot;temporal fraction&quot;</em><em>, </em><em>&quot;persistence&quot;</em><em>, </em><em>&quot;counts&quot;</em><em>, </em><em>&quot;transition frequency&quot;</em><em>]</em>) – The metrics to calculate. Available options include <cite>temporal fraction</cite>, <cite>persistence</cite>, <cite>counts</cite>, and <cite>transition frequency</cite>.</p></li>
<li><p><strong>return_df</strong> (<em>str</em><em>, </em><em>default=True</em>) – If True, returns the dataframe</p></li>
<li><p><strong>output_dir</strong> (<em>Path</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Directory to save dataframe to. The directory will be created if it does not exist. If None, dataframe will not be saved.</p></li>
<li><p><strong>file_name</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Will serve as a prefix to append to the saved file names for the dataframes, if <cite>output_dir</cite> is provided.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Dict[str, pd.DataFrame]</em> – Dictionary containing pandas DataFrames - one for each requested metric.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The presence of 0 for specific CAPs in the “temporal fraction”, “persistence”, or “counts” dataframes indicates that the participant had zero instances of a specific CAP.</p>
</div>
<p class="rubric">References</p>
<p>Liu, X., Zhang, N., Chang, C., &amp; Duyn, J. H. (2018). Co-activation patterns in resting-state fMRI signals. NeuroImage, 180, 485–494. <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2018.01.041">https://doi.org/10.1016/j.neuroimage.2018.01.041</a></p>
<p>Yang, H., Zhang, H., Di, X., Wang, S., Meng, C., Tian, L., &amp; Biswal, B. (2021). Reproducible coactivation patterns of functional brain networks reveal the aberrant dynamic state transition in schizophrenia.
NeuroImage, 237, 118193. <a class="reference external" href="https://doi.org/10.1016/j.neuroimage.2021.118193">https://doi.org/10.1016/j.neuroimage.2021.118193</a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neurocaps.analysis.CAP.caps2plot">
<span class="sig-name descname"><span class="pre">caps2plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix_title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_options</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'outer</span> <span class="pre">product'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">visual_scope</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'regions'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_figs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">subplots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/neurocaps/analysis/cap.html#CAP.caps2plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurocaps.analysis.CAP.caps2plot" title="Link to this definition"></a></dt>
<dd><p>Generate heatmaps and outer product plots of CAPs</p>
<p>This function produces seaborn heatmaps for each CAP. If groups were given when the CAP class was initialized, plotting will be done for all CAPs for all groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>Path</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Directory to save plots to. The directory will be created if it does not exist. If None, plots will not be saved.</p></li>
<li><p><strong>suffix_title</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Appended to the title of each plot as well as the name of the saved file if <cite>output_dir</cite> is provided.</p></li>
<li><p><strong>plot_options</strong> (<em>str</em><em> or </em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default=&quot;outer product&quot;</em>) – Type of plots to create. Options are “outer product” or “heatmap”.</p></li>
<li><p><strong>visual_scope</strong> (<em>str</em><em> or </em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default=&quot;regions&quot;</em>) – Determines whether plotting is done at the region level or node level.
For region level, the value of each nodes in the same regions are averaged together then plotted.
Options are “regions” or “nodes”.</p></li>
<li><p><strong>show_figs</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to display figures.</p></li>
<li><p><strong>subplots</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to produce subplots for outer product plots.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – <p>Keyword arguments used when saving figures. Valid keywords include:</p>
<ul>
<li><dl class="simple">
<dt>”dpi”: int, default=300</dt><dd><p>Dots per inch for the figure. Default is 300 if <cite>output_dir</cite> is provided and <cite>dpi</cite> is not specified.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”figsize”: Tuple, default=(8, 6)</dt><dd><p>Size of the figure in inches.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”fontsize”: int, default=14</dt><dd><p>Font size for the title of individual plots or subplots.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”hspace”: float, default=0.4</dt><dd><p>Height space between subplots.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”wspace”: float, default=0.4</dt><dd><p>Width space between subplots.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”xticklabels_size”: int, default=8</dt><dd><p>Font size for x-axis tick labels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”yticklabels_size”: int, default=8</dt><dd><p>Font size for y-axis tick labels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”shrink”: float, default=0.8</dt><dd><p>Fraction by which to shrink the colorbar.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”nrow”: int, varies;</dt><dd><p>Number of rows for subplots. Default varies.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”ncol”: int, default varies (max 5)</dt><dd><p>Number of columns for subplots. Default varies but the maximum is 5.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”suptitle_fontsize”: float, default=0.7</dt><dd><p>Font size for the main title when subplot is True.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”tight_layout”: bool, default=True</dt><dd><p>Use tight layout for subplots.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”rect”: List[int], default=[0, 0.03, 1, 0.95]</dt><dd><p>Rectangle parameter for tight layout when subplots are True to fix whitespace issues.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”sharey”: bool, default=True</dt><dd><p>Share y-axis labels for subplots.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”xlabel_rotation”: int, default=0</dt><dd><p>Rotation angle for x-axis labels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”ylabel_rotation”: int, default=0</dt><dd><p>Rotation angle for y-axis labels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”annot”: bool, default=False</dt><dd><p>Add values to cells.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”fmt”: str, default=”.2g”</dt><dd><p>Modify how the annotated vales are presented.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”linewidths”: float, default=0</dt><dd><p>Padding between each cell in the plot.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”borderwidths”: float, default=0</dt><dd><p>Width of the border around the plot.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”linecolor”: str, default=”black”</dt><dd><p>Color of the line that seperates each cell.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”edgecolors”: str or None, default=None</dt><dd><p>Color of the edges.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”alpha”: float or None, default=None</dt><dd><p>Controls transparancy and ranges from 0 (transparant) to 1 (opaque).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”hemisphere_labels”: bool, default=False</dt><dd><p>This option is only available when visual_scope=”nodes”. Instead of listing all individual labels, this parameter
simplifies the labels to indicate only the left and right hemispheres, with a division line separating the cells
belonging to each hemisphere. If set to True, “edgecolors” will not be used, and both “linewidths” and “linecolor”
will be applied only to the division line. This option is available exclusively for “Custom” and “Schaefer” parcellations.
WARNING, for the “Custom” option, the parcellation should be organized such that the first half of the labels/nodes belong to the left
hemisphere and the latter half to the right hemisphere.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”cmap”: str, Class, or Function, default=”coolwarm”</dt><dd><p>Color map for the cells in the plot. For this parameter, you can use premade color palettes or create custom ones.
Below is a list of valid options:</p>
<ul>
<li><p>Strings to call seaborn’s premade palettes. Refer to seaborn’s documentation for valid options.</p></li>
<li><p>Seaborn’s diverging_palette function to generate custom palettes.</p></li>
<li><p>Matplotlib’s LinearSegmentedColormap to generate custom palettes.</p></li>
<li><p>Other classes or functions compatible with seaborn.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”vmin”: float, default=None</dt><dd><p>The minimum value to display in plots.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”vmax”: float, default=None</dt><dd><p>The maximum value to display in plots.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>seaborn.heatmap</em> – An instance of a seaborn heatmap.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neurocaps.analysis.CAP.caps2corr">
<span class="sig-name descname"><span class="pre">caps2corr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix_title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_figs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/neurocaps/analysis/cap.html#CAP.caps2corr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurocaps.analysis.CAP.caps2corr" title="Link to this definition"></a></dt>
<dd><p>Generate Correlation Matrix</p>
<p>Produces the correlation matrix of all CAPs. If groups were given when the CAP class was initialized, a correlation matrix will be generated for each group.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>Path</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Directory to save plots to. The directory will be created if it does not exist. If None, plots will not be saved.</p></li>
<li><p><strong>suffix_title</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Appended to the title of each plot as well as the name of the saved file if <cite>output_dir</cite> is provided.</p></li>
<li><p><strong>show_figs</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to display figures.</p></li>
<li><p><strong>**kwargs</strong> (<em>Dict</em>) – <p>Keyword arguments used when saving figures. Valid keywords include:</p>
<ul>
<li><dl class="simple">
<dt>”dpi”: int, default=300</dt><dd><p>Dots per inch for the figure. Default is 300 if <cite>output_dir</cite> is provided and <cite>dpi</cite> is not specified.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”figsize”: Tuple, default=(8, 6)</dt><dd><p>Size of the figure in inches.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”fontsize”: int, default=14</dt><dd><p>Font size for the title of individual plots or subplots.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”xticklabels_size”: int, default=8</dt><dd><p>Font size for x-axis tick labels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”yticklabels_size”: int, default=8</dt><dd><p>Font size for y-axis tick labels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”shrink”: float, default=0.8</dt><dd><p>Fraction by which to shrink the colorbar.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”xlabel_rotation”: int, default=0</dt><dd><p>Rotation angle for x-axis labels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”ylabel_rotation”: int, default=0</dt><dd><p>Rotation angle for y-axis labels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”annot”: bool, default=False</dt><dd><p>Add values to each cell.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”fmt”: str, default=”.2g”,</dt><dd><p>Modify how the annotated vales are presented.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”linewidths”: float, default=0</dt><dd><p>Padding between each cell in the plot.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”borderwidths”: float, default=0</dt><dd><p>Width of the border around the plot.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”linecolor”: str, default=”black”</dt><dd><p>Color of the line that seperates each cell.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”edgecolors”: str, default=None</dt><dd><p>Color of the edges.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”alpha”: float, default=None</dt><dd><p>Controls transparancy and ranges from 0 (transparant) to 1 (opaque).</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”cmap”: str, Class, or function, default=”coolwarm”</dt><dd><p>Color map for the cells in the plot. For this parameter, you can use premade color palettes or create custom ones.
Below is a list of valid options:
- Strings to call seaborn’s premade palettes. Refer to seaborn’s documentation for valid options.
- Seaborn’s diverging_palette function to generate custom palettes.
- Matplotlib’s LinearSegmentedColormap to generate custom palettes.
- Other classes or functions compatible with seaborn.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>seaborn.heatmap</em> – An instance of a seaborn heatmap.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neurocaps.analysis.CAP.caps2niftis">
<span class="sig-name descname"><span class="pre">caps2niftis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix_file_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/neurocaps/analysis/cap.html#CAP.caps2niftis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurocaps.analysis.CAP.caps2niftis" title="Link to this definition"></a></dt>
<dd><p>Standalone method to convert caps to statistical maps</p>
<p>Converts atlas into a stat map by replacing labels with the corresponding from the cluster centroids then saves them as compressed nii files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>str</em><em>, </em><em>default=None</em>) – Directory to save plots to. The directory will be created if it does not exist.</p></li>
<li><p><strong>suffix_title</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Appended to the name of the saved file.</p></li>
<li><p><strong>fwhm</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Strength of spatial smoothing to apply (in millimeters) to the statistical map prior to interpolating from MNI152 space to fslr surface space.
Note, this can assist with coverage issues in the plot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>Nifti1Image</em> – Nifti statistical map.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neurocaps.analysis.CAP.caps2surf">
<span class="sig-name descname"><span class="pre">caps2surf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix_title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_figs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fwhm</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fslr_density</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'32k'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'linear'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_stat_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fslr_giftis_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/neurocaps/analysis/cap.html#CAP.caps2surf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurocaps.analysis.CAP.caps2surf" title="Link to this definition"></a></dt>
<dd><p>Project CAPs onto surface plots</p>
<p>Converts atlas into a stat map by replacing labels with the corresponding from the cluster centroids then plots on a surface plot.
This function uses surfplot for surface plotting.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>Path</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Directory to save plots to. The directory will be created if it does not exist. If None, plots will not be saved.</p></li>
<li><p><strong>suffix_title</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Appended to the title of each plot as well as the name of the saved file if <code class="docutils literal notranslate"><span class="pre">output_dir</span></code> is provided.</p></li>
<li><p><strong>show_figs</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to display figures.</p></li>
<li><p><strong>fwhm</strong> (<em>float</em><em> or </em><em>None</em><em>, </em><em>defualt=None</em>) – Strength of spatial smoothing to apply (in millimeters) to the statistical map prior to interpolating from MNI152 space to fslr surface space.
Note, this can assist with coverage issues in the plot.</p></li>
<li><p><strong>fslr_density</strong> (<em>str</em><em>, </em><em>default=&quot;32k&quot;</em>) – Density of the fslr surface when converting from MNI152 space to fslr surface. Options are “32k” or “164k”.
If using <code class="docutils literal notranslate"><span class="pre">fslr_giftis_dict</span></code> options are “4k”, “8k”, “32k”, and “164k”.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>default=&quot;linear&quot;</em>) – Interpolation method to use when converting from MNI152 space to fslr surface. Options are “linear” or “nearest”.</p></li>
<li><p><strong>save_stat_map</strong> (<em>bool</em><em>, </em><em>default=False</em>) – If True, saves the statistical map for each CAP for all groups as a Nifti1Image if <code class="docutils literal notranslate"><span class="pre">output_dir</span></code> is provided.</p></li>
<li><p><strong>fslr_giftis_dict</strong> (<em>dict</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – <p>Dictionary specifying precomputed gifti files in fslr space for plotting stat maps. This parameter should be used if the statistical CAP NIfTI files (can be obtained using <cite>caps2niftis</cite>)
were converted to GIfTI files using a tool such as Connectome Workbench.The dictionary structure is:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;GroupName&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;CAP-Name&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;lh&quot;</span><span class="p">:</span> <span class="s2">&quot;path/to/left_hemisphere_gifti&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rh&quot;</span><span class="p">:</span> <span class="s2">&quot;path/to/right_hemisphere_gifti&quot;</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>GroupName can be “All Subjects” or any specific group name. CAP-Name is the name of the CAP.
This parameter allows plotting without re-running the analysis. Initialize the CAP class and use this method if using this parameter.</p>
</p></li>
<li><p><strong>**kwargs</strong> (<em>Dict</em>) – <p>Additional parameters to pass to modify certain plot parameters. Options include:</p>
<ul>
<li><dl class="simple">
<dt>”dpi”: int, default=300</dt><dd><p>Dots per inch for the plot.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”title_pad”: int, default=-3</dt><dd><p>Padding for the plot title.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”cmap”: str or Class, default=”cold_hot”</dt><dd><p>Colormap to be used for the plot. For this parameter, you can use premade color palettes or create custom ones.
Below is a list of valid options:
- Strings to call nilearn’s _cmap_d fuction. Refer to documention for nilearn’s _cmap_d for valid palettes.
- Matplotlib’s LinearSegmentedColormap to generate custom colormaps.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>cbar_kws: Dict, default={“location”: “bottom”, “n_ticks”: 3}</dt><dd><p>Customize colorbar. Refer to <cite>_add_colorbars</cite> at <a class="reference external" href="https://surfplot.readthedocs.io/en/latest/generated/surfplot.plotting.Plot.html#surfplot.plotting.Plot">https://surfplot.readthedocs.io/en/latest/generated/surfplot.plotting.Plot.html#surfplot.plotting.Plot</a>
for valid kwargs.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”alpha”: float, default=1</dt><dd><p>Transparency level of the colorbar.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”zero_transparent”: bool, default=True</dt><dd><p>Turns vertices with a value of 0 transparent.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”as_outline”: bool, default=False</dt><dd><p>Plots only an outline of contiguous vertices with the same value.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”size”: Tuple, default=(500, 400)</dt><dd><p>Size of the plot in pixels.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”layout”: str, default=”grid”</dt><dd><p>Layout of the plot.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”zoom”: float, default=1.5</dt><dd><p>Zoom level for the plot.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”views”: List[str], default=[“lateral”, “medial”]</dt><dd><p>Views to be displayed in the plot.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”brightness”: float, default=0.5</dt><dd><p>Brightness level of the plot.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”figsize”: Tuple or None, default=None</dt><dd><p>Size of the figure.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”scale”: Tuple, default=(2, 2)</dt><dd><p>Scale factors for the plot.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”surface”: str, default=”inflated”</dt><dd><p>The surface atlas that is used for plotting. Options are “inflated” or “veryinflated”</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”color_range”: Tuple or None, default=None</dt><dd><p>The minimum and maximum value to display in plots. For instance, (-1,1) where minimum
value is first. If None, the minimum and maximum values from the image will be used.</p>
</dd>
</dl>
</li>
</ul>
<p>Please refer to surfplot’s documentation for specifics:
<a class="reference external" href="https://surfplot.readthedocs.io/en/latest/generated/surfplot.plotting.Plot.html#surfplot.plotting.Plot">https://surfplot.readthedocs.io/en/latest/generated/surfplot.plotting.Plot.html#surfplot.plotting.Plot</a></p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>Nifti1Image</em> – Nifti statistical map.</p></li>
<li><p><em>surfplot.Plot</em> – An instance of a surfplot plot.</p></li>
</ul>
</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Assumes that atlas background label is zero and atlas is in MNI space. Also assumes that the indices from the cluster centroids are related
to the atlas by an offset of one. For instance, index 0 of the cluster centroid vector is the first nonzero label, which is assumed to be at the
first index of the array in <code class="docutils literal notranslate"><span class="pre">sorted(np.unique(atlas_fdata))</span></code>.</p>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="neurocaps.analysis.CAP.caps2radar">
<span class="sig-name descname"><span class="pre">caps2radar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Path</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">suffix_title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_figs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_scatterpolar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/neurocaps/analysis/cap.html#CAP.caps2radar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#neurocaps.analysis.CAP.caps2radar" title="Link to this definition"></a></dt>
<dd><p>Generate Radar Plots</p>
<p>This method identifies networks/regions (across both hemispheres) in each CAP that show high amplitude (high activation relative to the mean zero if z-scored) and low amplitude (high deactivation relative
to the mean zero if z-scored) by using cosine similarity. This is accomplished by extracting the cluster centroids (CAPs), a 1 x ROI vector, and generating a binary vector
(a vector 1 x ROI vector consisting of 0’s and 1’s) where 1’s indicate the indices/ROIs (Regions of Interest) in a specific region. For instance, if elements at indices 0,
5, and 10 in the cluster centroid are nodes in the Visual Network, then a binary vector is generated where those indices are 1, and all others are 0. This binary vector
essentially operates like a 1-dimensional binary mask to capture relevant ROIs in a given region/network.</p>
<p>Once, the dot product of the cluster centroid and binary vector is then calculated it is normalized by the product of the norms of the cluster centroid and the binary
vector to restrict the range to -1 and 1, hence cosine similarity. For example, with the Schaefer 7-network parcellation, if your analysis has five CAPs, then each cluster
centroid (CAP) will be multiplied by seven different binary vectors (where the 1’s represent the nodes in that network).</p>
<p>Cosine similarities notably above zero suggest that many nodes in that network/region are highly activating together, cosine similarities around zero suggest that nodes in that
network/region are co-activating and deactivating together, and cosine similarities notably below zero suggest that many nodes in that network/region are deactivating together.</p>
<p>This method is a useful quantitative method to characterize CAPs based on nodes in region/networks that display high co-activation or high co-deactivation. For instance, if
the dorsal attention network (DAN) has the highest cosine similarity and the ventral attention network (VAN) has a lowest cosine similarity, then that cap can be described as
(DAN +/VAN -).</p>
<p><strong>Note, the radar plots only display positive values. The “Low Amplitude” group are negative cosine similarity (below zero); however, the absolute value was taken to
make them positive so that the radar plot starts at 0 and direct magnitude comparisons between the “High Amplitude” (positive cosine similarity above zero) and “Low Amplitude”
groups are easier.</strong></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>Path</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Directory to save plots to. The directory will be created if it does not exist.</p></li>
<li><p><strong>suffix_title</strong> (<em>str</em><em> or </em><em>None</em><em>, </em><em>default=None</em>) – Appended to the title of each plot as well as the name of the saved file if <cite>output_dir</cite> is provided.</p></li>
<li><p><strong>show_figs</strong> (<em>bool</em><em>, </em><em>default=True</em>) – Whether to display figures. If this function detects that it is not being ran in an interactive Python environment,
then it uses plotly.offline, creates an html file named “temp-plot.html”, and opens each plot in the default
browser.</p></li>
<li><p><strong>use_scatterpolar</strong> (<em>bool=True</em>) – Uses plotly’s Scatterpolar instead of plotly’s line_polar. The difference is that Scatterpolar shows the scatter
dots.</p></li>
<li><p><strong>**kwargs</strong> (<em>Dict</em>) – <p>Additional parameters to pass to modify certain plot parameters. Options include:</p>
<ul>
<li><dl class="simple">
<dt>”scale”: int, default=2</dt><dd><p>Controls resolution of image when saving.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”savefig_options”: Dict[str], default={“width”: 3, “height”: 3, “scale”: 1}</dt><dd><p>If <cite>output_dir</cite> provided, controls the width (in inches), height (in inches), and scale of the plot.
The height and width are multiplied by the dpi.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”height”: int, default=800</dt><dd><p>Height of the plot. Value is multiplied by the dpi when saving.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”width”: int, defualt=1200</dt><dd><p>Width of the plot. Value is multiplied by the dpi when saving.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”line_close”: int, default=True</dt><dd><p>Whether to close the lines</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”bgcolor”: str, default=”white”</dt><dd><p>Color of the background</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”scattersize”: int, default=8</dt><dd><p>If <cite>use_scatterpolar=True</cite>, controls the size of the dots.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”connectgaps”: bool, default=True</dt><dd><p>If <cite>use_scatterpolar=True</cite>, controls if missing values are connected.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”opacity”: float, default=0.5,</dt><dd><p>If <cite>use_scatterpolar=True</cite>, sets the opacity of the trace.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”fill”: str, default=”none”.</dt><dd><p>If “toself” the are of the dots and within the boundaries of the line will be filled.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”radialaxis”: dict, default={“showline”: False, “linewidth”: 2, “linecolor”: “rgba(0, 0, 0, 0.25)”, “gridcolor”: “rgba(0, 0, 0, 0.25)”, “ticks”: “outside”,”tickfont”: {“size”: 14, “color”: “black”}}</dt><dd><p>Customizes the radial axis. Refer to <a class="reference external" href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.layout.polar.radialaxis.html">https://plotly.com/python-api-reference/generated/plotly.graph_objects.layout.polar.radialaxis.html</a> or
<a class="reference external" href="https://plotly.com/python/reference/layout/polar/">https://plotly.com/python/reference/layout/polar/</a> for valid kwargs. Note if there is no “tickvals” key, the plot will only display
four ticks - [max_value/4, max_value/2, 3*max_value/4, max_value].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”angularaxis”: Dict[str], default= {“showline”: True, “linewidth”: 2, “linecolor”: “rgba(0, 0, 0, 0.25)”, “gridcolor”: “rgba(0, 0, 0, 0.25)”, “tickfont”: {“size”: 16, “color”: “black”}}</dt><dd><p>Customizes the angular axis. Refer to <a class="reference external" href="https://plotly.com/python-api-reference/generated/plotly.graph_objects.layout.polar.angularaxis.html">https://plotly.com/python-api-reference/generated/plotly.graph_objects.layout.polar.angularaxis.html</a>
or <a class="reference external" href="https://plotly.com/python/reference/layout/polar/">https://plotly.com/python/reference/layout/polar/</a> for valid kwargs.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>”color_discrete_map”: dict, default={“High Amplitude”: “red”, “Low Amplitude”: “blue”},</dt><dd><p>Change color of the “High Amplitude” and “Low Amplitude” groups. Must use the keys
“High Amplitude” and “Low Amplitude” to work.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>title_font: dict, default={“family”: “Times New Roman”, “size”: 30, “color”: “black”}</dt><dd><p>Modifies the font of the title. Refer to <a class="reference external" href="https://plotly.com/python/reference/layout/">https://plotly.com/python/reference/layout/</a> for valid kwargs.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>title_x: float, default=0.5</dt><dd><p>Modifies x position of title.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>title_y: float, default=None</dt><dd><p>Modifies y position of title.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>legend: Dict[str], default={“yanchor”: “top”, “xanchor”: “left”, “y”: 0.99, “x”: 0.01, “title_font_family”: “Times New Roman”, “font”: {“size”: 12, “color”: “black”}}</dt><dd><p>Customized legend. Refer to <a class="reference external" href="https://plotly.com/python/reference/layout/">https://plotly.com/python/reference/layout/</a> for valid kwargs.</p>
</dd>
</dl>
</li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><em>plotly.express.line_polar</em> – An instance of a plotly radar plot.</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><strong>To save, the kaleido package is needed, which is a dependency in this package. The kaleido package on Windows seems to only work with plotly if it is a specific version, such as version 0.1.0.post1*</strong></p>
</div>
<p class="rubric">References</p>
<p>Zhang, R., Yan, W., Manza, P., Shokri-Kojori, E., Demiral, S. B., Schwandt, M., Vines, L., Sotelo, D., Tomasi, D., Giddens, N. T., Wang, G., Diazgranados, N., Momenan, R., &amp; Volkow, N. D. (2023).
Disrupted brain state dynamics in opioid and alcohol use disorder: attenuation by nicotine use. Neuropsychopharmacology, 49(5), 876–884. <a class="reference external" href="https://doi.org/10.1038/s41386-023-01750-w">https://doi.org/10.1038/s41386-023-01750-w</a></p>
</dd></dl>

</section>
</dd></dl>

<div style='clear:both'></div></section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="neurocaps.extraction.TimeseriesExtractor.html" class="btn btn-neutral float-left" title="neurocaps.extraction.TimeseriesExtractor" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="neurocaps.analysis.merge_dicts.html" class="btn btn-neutral float-right" title="neurocaps.analysis.merge_dicts" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Donisha Smith.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>